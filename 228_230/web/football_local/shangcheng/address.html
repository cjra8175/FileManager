<!DOCTYPE html>
<html>
<head lang="en">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=0">

    <meta content="telephone=no" name="format-detection">
    <meta name="msapplication-tap-highlight" content="no">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="cleartype" content="on">
    <title>奖品记录</title>
    <link rel="stylesheet" href="../css/main.css">
    <style>body{background:#ebeef0}.bc{margin:15px 15px 0;text-align:center;line-height:44px;height:44px;background:#2479e2;color:#fff;border-radius:2px;font-size:16px}#address{padding-top:45px;width:100%}.listBox{width:100%;background:#fff}.list{position:relative;display:-webkit-box;height:50px;border-bottom:1px solid #ebeef0}.txtBox{height:85px;border:none;padding:15px 20px}.add{padding:0;height:100%;width:100%;border:none;outline:0;resize:none;color:#333;font-size:14px}.myAdd{padding:0;height:80%;width:100%;border:none;outline:0;resize:none;color:#666;font-size:14px}.question{-webkit-box-flex:1.1;width:0;line-height:50px;font-size:14px;color:#666}.question::before{content:" ";display:inline-block;width:20px;height:0;font-size:0}.answer{-webkit-box-flex:3;width:0;padding-left:20px}.answer input{width:100%;height:50px;border:none;outline:0;font-size:14px;color:#333}.answer input::-webkit-input-placeholder{color:#bdc3c7}textarea::-webkit-input-placeholder{color:#bdc3c7}#locality input::-webkit-input-placeholder{color:#8c8c8c}#locality input,#street input{text-align:right;width:88%}.anGt{position:absolute;right:2px;top:0;width:25px;height:50px;background-position:-128px -150px}.myList{background:#fff}.revisionsButton{margin:15px 15px 0;text-align:center;line-height:44px;height:44px;background:#2479e2;color:#fff;border-radius:2px;font-size:16px}.rankWarn{color:red;padding:0 15px 20px;font-size:14px;display:none}.user_award{line-height:20px;text-align:center;font-size:14px;color:red;padding:15px 20px;text-align:center;font-size:14px;color:red}</style>
    <script>if(/iPhone|iPad|iPod|ios|IOS/.test(window.navigator.userAgent)){var head=document.getElementsByTagName("head")[0],styleLink=document.createElement("link");styleLink.setAttribute("rel","stylesheet"),styleLink.setAttribute("href","../css/iosBar.css"),head.appendChild(styleLink)}</script>
</head>
<body>
<header class="sq_header" id="inHead">
    <div class="sq_headerUpBox" id="back"><b class="icon sq_headerUp"></b></div>
    <span class="sq_headerText">收货地址</span>
    
</header>
<section id="address">
    <div class="listBox">
        <div class="user_award hide"></div>
        <ul class="list">
            
            <li class="answer"><input type="text" id="userName" placeholder="收货人姓名"></li>
        </ul>
        <ul class="list">
            
            <li class="answer"><input type="text" id="userPhone" maxlength="15" placeholder="手机号码"></li>
        </ul>
        <ul class="list" id="locality">
            <li class="question">所在地区</li>
            <li class="answer"><input class="locality" type="text" placeholder="请选择" readonly="readonly"><b class="icon anGt"></b></li>
        </ul>
        <div class="txtBox">
            <textarea class="add" placeholder="详细地址"></textarea>
        </div>
        <p class="rankWarn">根据活动规则，用户同时进入多个日榜排行，只能选择其中一份奖品。客服会与获奖者确认领奖事宜。</p>
    </div>
    <div class="myList hide">
        <div class="user_award hide"></div>
        <ul class="list">
            
            <li class="answer"><input type="text" class="myName" readonly="readonly"></li>
        </ul>
        <ul class="list">
            
            <li class="answer"><input type="text" class="myPhone" readonly="readonly"></li>
        </ul>
        <div class="txtBox">
            <span style="font-size:14px;color:#666">所在地区</span>
            <textarea class="myAdd" readonly="readonly" style="margin-top:8px;height:80%"></textarea>
        </div>
        <p class="rankWarn">根据活动规则，用户同时进入多个日榜排行，只能选择其中一份奖品。客服会与获奖者确认领奖事宜。</p>
    </div>
    <div class="revisionsButton hide">修 改</div>
    <div class="bc">保存</div>
</section>
</body>
<script src="../js/lib/zeptoPpLoadNativeMap.min.js"></script>
<script src="../js/main.js"></script>
<script>var cityObj={},reverSet={},type=!1,Init=function(){var e=function(){if(!T.Util.isEmpty(T.Util.getPara("type"))&&"hdReal"==T.Util.getPara("type"))return void alert('<div><p style="color: #ff5b06;margin: -20px 0 10px;font-size: 18px;">领取成功!</p><p style="">两个工作日内会有工作人员与您联系，进行派奖。</p></div>',function(){Init.tjUtil(),api.closeWindow()},"我知道了")},t=function(){if(T.Util.isEmpty($("#userName").val()))return void tip("请输入收货人姓名");if(T.Util.isEmpty($("#userPhone").val()))return void tip("请输入手机号码");if(!/^1\d{10}$/.test($("#userPhone").val()))return void tip("请输入正确的手机号码");if("undefined"==cityObj.province)return void tip("请输入所在地区");if(T.Util.isEmpty($(".add").val()))return void tip("请输入详细地址");var t={reciver:$("#userName").val(),province:cityObj.province,city:cityObj.city,district:cityObj.district,address:$(".add").val(),mobile:$("#userPhone").val(),access_token:T.Storage.get("access_token")};T.Util.xmlHttpRequest({type:"post",reqUrl:"/forum/api/user/save_address",reqData:t,callback:function(t){e(),tip("保存成功"),o(),$(".add,#userPhone,#userName").blur()},errorCallback:function(){}})},i=function(){if(T.Util.isEmpty($("#userName").val()))return void tip("请输入收货人姓名");if(T.Util.isEmpty($("#userPhone").val()))return void tip("请输入手机号码");if(!/^1\d{10}$/.test($("#userPhone").val()))return void tip("请输入正确的手机号码");if(""==$(".locality"))return void tip("请输入所在地区");if(T.Util.isEmpty($(".add").val()))return void tip("请输入详细地址");var e={reciver:$("#userName").val(),province:"",city:"",district:$(".locality").val(),address:$(".add").val(),mobile:$("#userPhone").val(),access_token:T.Storage.get("access_token")};T.Util.xmlHttpRequest({type:"post",reqUrl:"/forum/api/user/save_address",reqData:e,callback:function(e){tip("保存成功"),o(),$(".add,#userPhone,#userName,.locality").blur()},errorCallback:function(){}})},r=function(){$(".bc").off().Touch(function(){if(T.Util.isEmpty(T.Storage.get("access_token")))return void T.Util.login();type?i():t()}),$("#locality").off().Touch(function(){T.isNative&&Global.isAndroid&&lib.nativeApi.compareVersion("2.4.1")||Global.isiOS&&lib.nativeApi.compareVersion("2.3.1")?($(".locality").attr("readonly","readonly"),$("#locality input,.add,#userPhone,#userName").blur(),api.openAddressSelect({},function(e){cityObj=e.result,$("#locality input").val(cityObj.province+" "+cityObj.city+" "+cityObj.district)})):($(".locality").removeAttr("readonly"),$(".locality").focus(),type=!0)}),$(".revisionsButton").off().Touch(function(){$(".sq_headerText").html("收货地址"),$(".myList").hide(),$(".listBox").show(),$(".revisionsButton").hide(),$(".bc").show(),$("#userName").val(reverSet.reciver),$("#userPhone").val(reverSet.mobile),T.Util.isEmpty(reverSet.province)?$(".locality").val(reverSet.district):$(".locality").val(reverSet.province+" "+reverSet.city+" "+reverSet.district),$(".add").val(reverSet.address)})},o=function(){T.Util.xmlHttpRequest({type:"get",reqUrl:"/forum/api/user/get_user_address?access_token="+T.Storage.get("access_token"),callback:function(t){var i=t.get_user_address;if(i&&!T.Util.isEmpty(i.mobile)){var r={province:i.province,city:i.city,district:i.district};cityObj=r,reverSet=i,$(".sq_headerText").html("我的信息"),$(".myList").show(),$(".listBox").hide(),$(".myName").val(i.reciver),$(".myPhone").val(i.mobile),T.Util.isEmpty(i.province)?$(".myAdd").val(i.district+" "+i.address):$(".myAdd").val(i.province+" "+i.city+" "+i.district+" "+i.address),$(".revisionsButton").show(),$(".bc").hide(),e()}},errorCallback:function(){}})},a=function(){"rankingList"==T.Util.getPara("type")&&"many"==T.Util.getPara("rankType")&&$(".rankWarn").show(),T.Util.isEmpty(T.Storage.get("access_token"))||o(),r()};return{tjUtil:function(){$.ajax({type:"get",url:window.location.origin+"?hdReceiveType="+T.Util.getPara("type")+"&a="+Math.random(),dataType:"html",timeout:15e3,success:function(e){console.log("！下载打点地址成功")},error:function(e,t){}})},init:a}}();$(document).ready(function(){function e(){if(T.Util.isEmpty(T.Util.getPara("type"))||"hdBill"!=T.Util.getPara("type"))T.Util.isEmpty(T.Util.getPara("code"))||"sys"!=T.Util.getPara("code")||T.Util.xmlHttpRequest({type:"get",reqUrl:"/web/services/order/code/record.json?token="+T.Storage.get("access_token")+"&type=2&activity_id=714",callback:function(e){var t="",i="",r=e.res_data.value;if(r.length){for(var o=0;o<r.length;o++)t="",r[o].name.indexOf("M")>-1&&(t="流量"),i+=o>0?","+r[o].name+t:r[o].name+t;$(".user_award").html("恭喜获得"+i).removeClass("hide")}},errorCallback:function(e){}}),Init.init();else{if(T.Util.isEmpty(T.Storage.get("access_token")))return void T.Util.login();var t=T.Storage.get("userinfo");if(T.Util.isEmpty(t))return void T.Util.login();if(T.Util.isEmpty(t.mobile_phone))return void api.openBindPhone({},function(t){"10"==t.result.bindResult?T.User.getUInfo(T.Storage.get("access_token"),e):tip("绑定失败")});alert('<div><p style="color: #ff5b06;margin: -20px 0 10px;font-size: 18px;">领取成功!</p><p style="">话费将在3个工作日内充值到您绑定的手机号。</p></div>',function(){Init.tjUtil(),api.closeWindow()},"我知道了")}}T.isNative?T.appToH5.init(e):T.Util.isEmpty(T.Storage.get("access_token"))?(T.Storage.remove("access_token"),T.Storage.remove("userinfo"),e()):T.User.getUInfo(T.Storage.get("access_token"),e)})</script>
</html>