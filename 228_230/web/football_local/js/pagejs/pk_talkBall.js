/* !v1-1.0.0.js 2018-01-10 */

var MessageObj=function(){var a=1,b=10,c=0,d=0,e=0,f=!0,g=!0,h=0,i={pageIdx:1,pageSize:10,isReturned:!0,hasMore:!0},j={pageIdx:1,pageSize:20,isReturned:!0,hasMore:!0},k={allInfos:[],atInfos:[],talkInfos:[],packetInfos:[]},l=0,m={NORMAL:0,SHARE:1,PACKET:2,PACKET_TIP:3},n=0,o={shareOrderInfo:new Map,shareRecommendInfo:new Map},p=function(){$(".xuan-con").off().Touch(function(){$(".xuan-list").toggle()}),$(".xuan-list li").off().Touch(function(){var a=$(this).text();$(this).addClass("on").siblings().removeClass("on"),$(".xuan-txt").text(a),0==$(this).index()?z("all"):1==$(this).index()?z("@"):2==$(this).index()?z("talk"):3==$(this).index()&&z("packet"),A(),$(".xuan-list").toggle()}),$(".talk-add").off().Touch(function(){"none"==$(".talk-tab").css("display")&&$(".said-textarea").blur(),setTimeout(function(){$(".talk-tab").toggle()},300)}),$(".sendPacket").off().Touch(function(){if(T.Util.isEmpty(T.Storage.get("access_token")))return void T.Util.login();$(".talk-tab").hide(),T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/pkField/sendHb.html?roomId="+T.Util.getPara("roomId"))}),$(".talk-send").off().Touch(function(){return 0==$(".said-textarea").val().replace(/\s/g,"").length?(tip("请输入要发送的内容"),!1):T.Util.isEmpty(T.Storage.get("access_token"))?void T.Util.login():void u()}),$(".shareOrders").off().Touch(function(){if(T.Util.isEmpty(T.Storage.get("access_token")))return void T.Util.login();$(this).find(".talkno-icon2").length||($(".talk-tab").hide(),i={pageIdx:1,pageSize:10,isReturned:!0,hasMore:!0},T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/pkField/shareInfo.html?shareType=order&roomId="+T.Util.getPara("roomId")))}),$(".shareRecommend").off().Touch(function(){if(T.Util.isEmpty(T.Storage.get("access_token")))return void T.Util.login();$(this).find(".talkno-icon3").length||($(".talk-tab").hide(),j={pageIdx:1,pageSize:20,isReturned:!0,hasMore:!0},T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/pkField/shareInfo.html?shareType=recommend&roomId="+T.Util.getPara("roomId")))}),$(".mine-close").off().Touch(function(){T.Util.back()}),$(window).scroll(function(){0==$(window).scrollTop()?t("up",!1):$(window).scrollTop()+$(window).height()+2>=$(document).height()&&($(".tipAt,.tipNews").addClass("hide"),h=0,l=0)}),$(".pk-bg").off().Touch(function(){$(".pk-bg").hide(),$(".hb-weebox,.hb-none,.hb-after").removeClass("hb-show")}),Global.isiOS?($("#textarea").off().on("focus",function(){$(".talk-tab").hide();var a=$(".pk-main").height()+160>document.documentElement.clientHeight?"relative":"absolute";$(".talk-footer").css("position",a),setTimeout(function(){textarea.scrollIntoView()},500)}).on("focusout",function(){$(".talk-footer").css("position","fixed")}),$(".talkBall-main").on("touchstart",function(){$(".said-textarea").blur()})):$(".said-textarea").off().on("focus",function(){$(".talk-tab").hide()})},r=function(){p(),a=1,b=10,c=0,d=0,e=0,h=0,f=!0,g=!0,k={allInfos:[],atInfos:[],talkInfos:[],packetInfos:[]},MessageObj.getMessage("down",!0,function(){$(window).scrollTop()+$(window).height()+2>=$(document).height()&&(document.body.scrollTop=99999)}),window.clearInterval(n),n=setInterval(function(){MessageObj.getMessage("down",!1)},5e3),T.Util.isEmpty(T.Storage.get("access_token"))||(H(),T.Storage.get("pkInfo").USER_ID==T.Storage.get("userinfo").user_no&&$(".shareOrders").addClass("hide"))},s=function(){window.clearTimeout(n)},t=function(i,j,k){if(g){g=!1;var l={obj_type:5,obj_id:T.Util.getPara("roomId"),page_index:a,page_size:b,contain_share:1,comment_type:0};T.Util.isEmpty(T.Storage.get("access_token"))||(l.access_token=T.Storage.get("access_token")),i&&"up"==i?l.end_id=0==e?c:e:i&&"down"==i&&!f&&(l.start_id=d),T.Util.xmlHttpRequest({hostFlag:"appweb",type:"post",reqUrl:"/app-web/api/comment/qry_comments",reqData:{qry_comments:l},errorType:"none",callback:function(a){if(a.qry_comments&&a.qry_comments.data&&a.qry_comments.data.length){j&&$(".talkBall-main").empty(),$(".no-content").remove(),i&&"down"==i?(d=a.qry_comments.data[0].comment_id,c=a.qry_comments.data[a.qry_comments.data.length-1].comment_id,!j&&!k&&$(window).scrollTop()+$(window).height()+2<=$(document).height()&&(h+=a.qry_comments.data.length,$(".news-count").html(h),$(".tipNews").removeClass("hide"))):e=a.qry_comments.data[a.qry_comments.data.length-1].comment_id;var b=i&&"up"==i?a.qry_comments.data:a.qry_comments.data.reverse(),l=$(window).scrollTop()+$(window).height()+2>=$(document).height();$.each(b,function(a,b){$(".talBallMsg[data-id='"+b.comment_id+"']").length||(y(i,b),i&&"up"==i?v(b)&&$(".talkBall-main").prepend(w(b.content_type,b)):v(b)&&$(".talkBall-main").append(w(b.content_type,b)))}),$(".talkBall-main .talkBall-mine").length+$(".talkBall-main .talkBall-other").length+$(".hb-tips").length==0&&$(".talkBall-main").empty().append('<div class="no-content"><div class="none-icon"></div><div class="none-txt">空空荡荡...</div></div>'),(j||l)&&(document.body.scrollTop=99999),A()}else f&&$(".talkBall-main").empty().append('<div class="no-content"><div class="none-icon"></div><div class="none-txt">空空荡荡...</div></div>');f=!1,g=!0,"function"==typeof k&&k()},errorCallback:function(){f=!1,g=!0}})}},u=function(){var a={obj_type:5,obj_id:T.Util.getPara("roomId"),access_token:T.Storage.get("access_token"),content:$(".said-textarea").val()},b=[];if($(".hasAt").length){var c="",d=$(".said-textarea").val();$.each($(".hasAt"),function(a,e){c=$(e).parent().parent(),-1!=d.indexOf("@"+$(c).find(".talkBall-name").html()+" ")&&-1==b.join("").indexOf($(e).attr("user_no"))&&b.push($(e).attr("user_no"))})}b.length&&(a.tuser_code=b.join(",")),T.Util.xmlHttpRequest({hostFlag:"appweb",type:"post",reqUrl:"/app-web/api/comment/add_comment",reqData:{add_comment:a},callback:function(a){$(".said-textarea").val(""),$(".talkBall-img").removeClass("hasAt"),t("down",!1,function(){document.body.scrollTop=99999})},errorCallback:function(){}})},v=function(a){var b=$(".xuan-list li.on").index(),c=!1;return 0==b?c=!0:1==b&&a.content_type==m.NORMAL&&void 0!==a.is_at&&1==a.is_at?c=!0:2!=b||a.content_type!=m.NORMAL||void 0!==a.is_at&&0!=a.is_at?3!=b||a.content_type!=m.PACKET&&a.content_type!=m.PACKET_TIP||(c=!0):c=!0,c},w=function(a,b){var c="",d=0==b.is_self?"other":"mine",e=0==b.is_expert?"":"t1-expert";if(a==m.NORMAL)c='<div class="talBallMsg talkBall-'+d+' clearfix" data-id="'+b.comment_id+'"><div class="talkBall-user"><img src="'+b.portrait_pic+'" class="talkBall-img" user_no="'+b.user_no+'"></div><div class="talkBall-intro"><div class="talkBall-t1"><em class="talkBall-name '+e+'">'+b.nickname+'</em><span class="talkBall-time">'+b.time_desc+'</span></div><div class="talkBall-box">'+b.content+"</div></div></div>";else if(a==m.PACKET)c='<div class="talBallMsg talkBall-'+d+' clearfix" data-id="'+b.comment_id+'"><div class="talkBall-user"><img src="'+b.portrait_pic+'" class="talkBall-img" user_no="'+b.user_no+'"></div><div class="talkBall-intro"><div class="talkBall-t1"><em class="talkBall-name '+e+'">'+b.nickname+'</em><span class="talkBall-time">'+b.time_desc+'</span></div><div class="talkBall-hb" packet_id="'+(b.comment_info?JSON.parse(b.comment_info).p_id:"")+'"><div class="hb-con"><div class="hb-img"></div><div class="hb-talk"><div class="hb-title">'+b.content+'</div><div class="hb-sum">领取红包</div></div></div><div class="hb-copy">百盈红包</div></div></div></div>';else if(a==m.SHARE){if(0==b.share_info.share_type){var f=T.betClubInfo.getBetInfoByStatus(b.share_info.item_status);c='<div class="talBallMsg talkBall-'+d+' clearfix" data-id="'+b.comment_id+'"><div class="talkBall-user"><img src="'+b.portrait_pic+'" class="talkBall-img" user_no="'+b.user_no+'"></div><div class="talkBall-intro"><div class="talkBall-t1"><em class="talkBall-name '+e+'">'+b.nickname+'</em><span class="talkBall-time">'+b.time_desc+'</span></div><div class="talkBall-box shareOrderWrap" match-id="'+b.share_info.match_id+'"  user-no="'+b.user_no+'" item-id="'+b.share_info.item_id+'" share-key="'+b.share_info.share_key+'"><div class="tj-list"><ul><li><span class="tj-label">类型：</span>'+b.share_info.order_type+'<span class="tj-style">('+(1==b.share_info.is_inplay?"赛前":"滚球")+')</span></li><li><span class="tj-label">投注：</span>'+b.share_info.item_bet+'<em class="bei">@'+b.share_info.match_odds+'</em></li><li><span class="tj-label">投注金币：</span>'+T.Util.parseNumber(b.share_info.item_money)+'</li><li><span class="tj-label"><span class="retText">'+f.resultText+'</span></span><span class="'+f.retMoneyCls+'">'+T.betClubInfo.getBetRetMoney(f,b.share_info)+'</span></li></ul><span class="'+f.resultCls+'">'+f.result+'</span></div><div class="sd-bottom"><i class="sd-icon"></i>我要晒单</div></div></div></div>'}else if(1==b.share_info.share_type){var g="竞彩单关";2==b.share_info.recom_type?g="亚盘":3==b.share_info.recom_type&&(g="大小球"),c='<div class="talBallMsg talkBall-'+d+' clearfix" data-id="'+b.comment_id+'"><div class="talkBall-user"><img src="'+b.portrait_pic+'" class="talkBall-img" user_no="'+b.user_no+'"></div><div class="talkBall-intro"><div class="talkBall-t1"><em class="talkBall-name '+e+'">'+b.nickname+'</em><span class="talkBall-time">'+b.time_desc+'</span></div><div class="talkBall-box shareRecWrap" user-no="'+b.user_no+'"><div class="tj-list"><ul><li><span class="tj-label">类型：</span>'+g+'<span class="tj-zhong">'+b.share_info.tip+'</span></li><li><span class="tj-label">推荐：</span>'+x(b.share_info)+'</li></ul></div><div class="sd-bottom"><i class="tj-icon"></i>专家推荐</div></div></div></div>'}}else a==m.PACKET_TIP&&(c='<div class="talBallMsg hb-tips" data-id="'+b.comment_id+'"><div class="hb-xin"><div class="hb-qiang"><i class="hb-s"></i>'+b.content.replace("红包",'<span class="tip-packet" packet_id="'+(b.comment_info?JSON.parse(b.comment_info).p_id:"")+'">红包</span>')+"</div></div></div>");return c},x=function(a){var b="";return 0==a.is_hit?b=a.price+'钻查看<i class="zuan-icon"></i><span class="look-count">已有'+a.buy_num+"人查看</span>":1==a.is_hit?b=a.forcast+'<span class="win-btn" style="margin-top:0;">赢</span>':-1==a.is_hit?b=a.forcast+'<span class="lose-btn" style="margin-top:0;">输</span>':2==a.is_hit&&(b=a.forcast+'<span class="zou-btn" style="margin-top:0;">走</span>'),b},y=function(a,b){a&&"down"==a?k.allInfos.push(b):k.allInfos.unshift(b),b.content_type!=m.NORMAL||void 0!==b.is_at&&0!=b.is_at?b.content_type==m.PACKET||b.content_type==m.PACKET_TIP?a&&"down"==a?k.packetInfos.push(b):k.packetInfos.unshift(b):b.content_type==m.NORMAL&&void 0!==b.is_at&&1==b.is_at&&(a&&"down"==a?(k.atInfos.push(b),-1!=b.tuser_no.join(",").indexOf(T.Storage.get("userinfo").user_no)&&$(window).scrollTop()+$(window).height()+2<=$(document).height()&&(l++,$(".at-username").html(1==l?b.nickname:"有"+l+"人"),$(".tipAt").removeClass("hide"))):k.atInfos.unshift(b)):a&&"down"==a?k.talkInfos.push(b):k.talkInfos.unshift(b)},z=function(a){var b=[];"all"==a?b=k.allInfos:"@"==a?b=k.atInfos:"talk"==a?b=k.talkInfos:"packet"==a&&(b=k.packetInfos),b.length?($(".talkBall-main").empty(),$(".no-content").remove(),$.each(b,function(a,b){$(".talkBall-main").append(w(b.content_type,b))})):$(".talkBall-main").empty().append('<div class="no-content"><div class="none-icon"></div><div class="none-txt">空空荡荡...</div></div>')},A=function(){$(".talkBall-hb").off().Touch(function(){T.Util.isEmpty($(this).attr("packet_id"))||C($(this).attr("packet_id"))}),$(".hb-close").off().Touch(function(){$(".pk-bg").toggle(),$(this).parent().toggleClass("hb-show")}),$(".hb-shou").off().Touch(function(){$(this).addClass("shou-do"),T.Util.isEmpty($(this).attr("packet_id"))||B($(this).attr("packet_id"))},{noRepeat:1}),$(".hb-weebox .hb-bottom,.hb-none .hb-bottom").off().Touch(function(){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/pkField/buyinHbInfo.html?roomId="+T.Util.getPara("roomId")+"&packetId="+$(this).attr("packet_id"))},{noRepeat:1}),$(".talkBall-other .talkBall-img").off().longPress(function(a){var b=$(a).parent().parent();$(a).addClass("hasAt"),-1==$(".said-textarea").val().indexOf($(b).find(".talkBall-name").html())&&$(".said-textarea").val($(".said-textarea").val()+"@"+$(b).find(".talkBall-name").html()+" ")}),$(".talkBall-other .talkBall-img").Touch(function(a){$(a).parent().parent();T.isNative&&api.openBetInfoPage({user_no:$(a).attr("user_no")},function(){})}),$(".talkBall-mine .talkBall-img").off().Touch(function(a){$(a).parent().parent();T.isNative&&api.openBetInfoPage({user_no:$(a).attr("user_no")},function(){})}),$(".tip-packet").off().Touch(function(){T.Util.isEmpty($(this).attr("packet_id"))||C($(this).attr("packet_id"))},{noRepeat:1}),$(".mine-packet").off().Touch(function(){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/pkField/mineHb.html")},{noRepeat:1}),$(".shareOrderWrap").off().Touch(function(){if(T.Util.isEmpty(T.Storage.get("access_token")))return void T.Util.login();T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/game/betPlan.html?uid="+$(this).attr("user-no")+"&key="+$(this).attr("share-key")+"&oid="+$(this).attr("item-id")+"&match_id="+$(this).attr("match-id"))},{noRepeat:1}),$(".shareRecWrap").off().Touch(function(){if(T.Util.isEmpty(T.Storage.get("access_token")))return void T.Util.login();T.isNative&&api.openBloggerPage({user_no:$(this).attr("user-no")},function(){})},{noRepeat:1}),$(".tipNews").off().Touch(function(){document.body.scrollTop=99999,h=0,l=0,$(".tipAt,.tipNews").addClass("hide")}),$(".tipAt").off().Touch(function(){$(".tipAt").addClass("hide"),l=0,$(".xuan-list li").removeClass("on"),$(".xuan-list li").eq(1).addClass("on"),$(".xuan-txt").html("只看@我的"),z("@")})},B=function(a){T.Util.xmlHttpRequest({hostFlag:"appweb",type:"get",reqUrl:"/web/services/room/packet/recive.json?token="+T.Storage.get("access_token")+"&p_id="+a+"&type=2&id="+T.Util.getPara("roomId"),callback:function(b){tip("领取成功"),$(".hb-weebox").removeClass("hb-show"),$(".pk-bg").hide(),T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/pkField/buyinHbInfo.html?roomId="+T.Util.getPara("roomId")+"&packetId="+a)},errorCallback:function(b){b&&"1082"==b.msg_code&&T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/pkField/buyinHbInfo.html?roomId="+T.Util.getPara("roomId")+"&packetId="+a)}})},C=function(a){T.Util.xmlHttpRequest({type:"get",reqUrl:"/web/services/room/packet.json?token="+T.Storage.get("access_token")+"&p_id="+a,callback:function(a){if(a.res_data&&a.res_data.value){var b=a.res_data.value;T.Util.isEmpty(b)||D(b)}},errorCallback:function(){}})},D=function(a){var b=T.Storage.get("userinfo").user_no==a.USER_ID,c=a.TYPE,d=a.IS_RECIVE;1==a.STATUS?b&&2==c||d?T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/pkField/buyinHbInfo.html?roomId="+T.Util.getPara("roomId")+"&packetId="+a.ID):($(".hb-weebox .hb-peo").attr("src",a.USER_PIC),$(".hb-weebox .peo-name").html(a.NICK_NAME),$(".hb-weebox .peo-tips").html("发了一个红包，"+(1==a.TYPE?"金额随机":"金额等分")),$(".hb-weebox .peo-txt").html(a.PACKET_SIGN),$(".hb-weebox").height(43==$(".hb-weebox .peo-txt").height()?380:398),$(".hb-weebox .hb-shou,.hb-weebox .hb-bottom").attr("packet_id",a.ID),$(".pk-bg").toggle(),$(".hb-weebox").toggleClass("hb-show"),2==c&&!b||1==c&&!b?$(".hb-weebox .hb-bottom").hide():$(".hb-weebox .hb-bottom").show()):2==a.STATUS?b&&2==c||d?T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/pkField/buyinHbInfo.html?roomId="+T.Util.getPara("roomId")+"&packetId="+a.ID):(2==c?($(".hb-none .peo-txt").html("该红包已被领取"),$(".hb-none .hb-bottom").hide()):($(".hb-none .peo-txt").html("手慢了，红包派完了"),$(".hb-none .hb-bottom").show()),$(".hb-none .hb-peo").attr("src",a.USER_PIC),$(".hb-none .peo-name").html(a.NICK_NAME),$(".pk-bg").toggle(),$(".hb-bottom").attr("packet_id",a.ID),$(".hb-none").toggleClass("hb-show")):3==a.STATUS&&($(".hb-after .hb-peo").attr("src",a.USER_PIC),$(".hb-after .peo-name").html(a.NICK_NAME),$(".pk-bg").toggle(),$(".hb-after").toggleClass("hb-show"))},E=function(a){a=a||"";var b=""==a?"1":"";T.Util.xmlHttpRequest({type:"get",reqUrl:"/web/services/room/orderInfo.json?token="+T.Storage.get("access_token")+"&c_time="+a+"&type=&r_id="+T.Util.getPara("roomId")+"&page="+i.pageIdx+"&limit="+i.pageSize+"&all_bet="+b+"&g_type=N",callback:function(b){if(b.res_data&&b.res_data.value){var c=[],d=b.res_data.value,e=b.res_data.value.O_LIST,f="";if(e.length){""==a&&$(".usertz-list").empty();for(var g=0,h=e.length;g<h;g++){if(!$(".TZ_listBox[data-time='"+e[0].DATES+"']").length){var i=[];i[g]=e[g].DATES,i[g]=i[g].substr(0,4)+"-"+i[g].substr(-4,2)+"-"+i[g].substr(6);var j=["日","一","二","三","四","五","六"],k="",l="time_up",m="hide",n="0";0==g&&(n="1",k="time_first",l="time_down",m=""),c.push('<div class="TZ_listBox" data-time="'+e[g].DATES+'" data-page="'+n+'"><ul class="time_list '+k+'"><li class="timeL"><span>'+i[g]+' </span><span class="timeR_bai">星期'+j[new Date(new Date(i[g]).getTime()).getDay()]+'</span></li><li class="timeRight"><span>&nbsp;</span><span>&nbsp;</span><b class="'+l+'"></b></li></ul><div class="time_listContent '+m+'">')}if(f=e[0].DATES,e[g].O_INFO){var o=e[g].O_INFO.DATA;for(q in o)c.push(T.betClubInfo.fillSignBetInfo(o[q]));1!=e[g].O_INFO.IS_END&&c.push('<div class="loadMore"   data-time="'+d.CUR_DATE+'">查看更多记录</div>')}c.push("</div></div>")}$(".TZ_listBox[data-time='"+f+"']").length?($(".TZ_listBox[data-time='"+f+"'] .time_listContent").removeClass("hide").append(c.join("")),G(f)):$(".usertz-list").append(c.join("")),I()}else $(".usertz-list").html('<div class="noRecord one"><div class="icon noGame"></div><div class="txtDesc"><p class="txtTitle">暂时还没有订单呢</p></div></div>')}},errorCallback:function(){}})},F=function(){T.Util.xmlHttpRequest({type:"get",reqUrl:"/web/services/room/recommendList.json?token="+T.Storage.get("access_token")+"&s_type=2&s_id="+T.Util.getPara("roomId"),callback:function(a){if(a.res_data&&a.res_data.value&&a.res_data.value.length){$(".minetj-con").empty().append("<ul></ul>");var b='<span class="zou-btn">走</span>';$.each(a.res_data.value,function(a,c){var d=T.betClubInfo.getRecInfoByRecItem(c);b=0==c.isHit?'<span class="dan-look">'+d.recRet+"</span>":'<span class="'+d.recRetCls+'">'+d.recRet+"</span>",$(".minetj-con ul").append('<li class="recommendItem"><span class="xuan-icon" data-id="'+c.recomId+'"></span><div class="minetj-lx">推荐类型：<span class="minetj-txt">'+d.recType+'</span></div><div class="minetj-xuan">推荐选项：<span class="minetj-txt">'+d.recOps+"</span></div>"+b+"</li>")}),O()}else $(".minetj-con").empty().append('<div class="noRecord one"><div class="icon noGame"></div><div class="txtDesc"><p class="txtTitle">暂时还没有推荐呢</p></div></div>')},errorCallback:function(){}})},G=function(a){var b=$(".TZ_listBox[data-time='"+a+"']");$(b).attr("data-page","1"),$(b).find(".time_list").toggleClass("time_first"),$(b).find(".time_up").length?$(b).find(".time_up").removeClass("time_up").addClass("time_down"):$(b).find(".time_down").removeClass("time_down").addClass("time_up")},H=function(){T.Util.xmlHttpRequest({type:"get",reqUrl:"/auth-web/api/user/get_user?access_token="+T.Storage.get("access_token"),callback:function(a){a&&a.get_user&&(a.get_user.is_expert||$(".shareRecommend").hide())},errorCallback:function(){}})},I=function(){$(".loadMore").off().Touch(function(a){i.pageIdx++,E($(a).attr("data-time")),$(a).remove()}),$(".TZ_list").off().Touch(function(a){if($(".mine-record .xuan-icon.xuan-on").length>=3&&!$(a).find(".xuan-icon").hasClass("xuan-on"))return void tip("最多分享三个订单");$(a).find(".xuan-icon").toggleClass("xuan-on"),$(".send-number").html($(".mine-record .xuan-icon.xuan-on").length),$(".mine-record .xuan-icon.xuan-on").length?$(".send-fix").removeClass("send-no"):$(".send-fix").addClass("send-no")}),$(".time_list").off().Touch(function(a){1==$(a).parent().attr("data-page")?($(a).parent().find(".time_listContent").toggleClass("hide"),$(a).parent().find(".time_list").toggleClass("time_first"),$(a).parent().find(".time_up").length?$(a).parent().find(".time_up").removeClass("time_up").addClass("time_down"):$(a).parent().find(".time_down").removeClass("time_down").addClass("time_up")):E($(a).parent().attr("data-time"))}),$(".send-fix").off().Touch(function(a){$(this).hasClass("send-no")?tip(1==MessageObj.shareType?"请选择要分享的订单":"请选择要分享的推荐"):1==MessageObj.shareType?J():2==MessageObj.shareType&&K()},{noRepeat:1})},J=function(){var a="";$(".mine-record .xuan-icon.xuan-on").length&&$.each($(".mine-record .xuan-icon.xuan-on"),function(b,c){a+=$(c).parent().find(".seleBox").attr("data-itemid")+","}),a=a.substr(0,a.length-1);var b=1;$(".mine-record .xuan-icon.xuan-on").length>3&&(b=2);var c={token:T.Storage.get("access_token"),data:{itemIds:a,isSite:b},time:(new Date).getTime()},d={add_share:{access_token:T.Storage.get("access_token"),obj_id:a,share_type:"0",item_id:T.Util.getPara("roomId")}};T.Util.xmlHttpRequest({reqUrl:"/web/services/order/items/share.json",type:"post",reqData:c,callback:function(a){d.add_share.obj_id=a.res_data.value,T.Util.xmlHttpRequest({reqUrl:"/app-web/api/comment/add_share.json",type:"post",reqData:d,callback:function(a){tip("晒单成功"),setTimeout(function(){T.Util.back()},500)},errorCallback:function(){}})},errorCallback:function(){}})},K=function(){var a="";$(".mine-tj .xuan-icon.xuan-on").length&&$.each($(".mine-tj .xuan-icon.xuan-on"),function(b,c){a+=$(c).attr("data-id")+","}),a=a.substr(0,a.length-1);var b={add_share:{access_token:T.Storage.get("access_token"),obj_id:a,share_type:"1",item_id:T.Util.getPara("roomId")}};T.Util.xmlHttpRequest({reqUrl:"/app-web/api/comment/add_share.json",type:"post",reqData:b,callback:function(a){tip("发起成功"),setTimeout(function(){T.Util.back()},500)},errorCallback:function(){}})},L=function(a){o=N();var b=a||3e5,c={millSecond:0,timer:0},d=new Map;$(".talk-shareOrderIcon").removeClass("talk-icon2").addClass("talkno-icon2");var e=setInterval(function(){var a=o.shareOrderInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no).millSecond;a>0?(a-=1e3,o.shareOrderInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no).millSecond=a,$(".shareOrders .tab-name").html(new Date(a).format("mm:ss"))):(o.shareOrderInfo.get(T.Storage.get("pkInfo").ROOM_CODE).remove(T.Storage.get("userinfo").user_no),$(".talk-shareOrderIcon").removeClass("talkno-icon2").addClass("talk-icon2"),$(".shareOrders .tab-name").html("分享订单"),window.clearInterval(e)),T.Storage.set("LQ_timer",o)},1e3);c.timer=e,c.millSecond=b,d.put(T.Storage.get("userinfo").user_no,c),o.shareOrderInfo.put(T.Storage.get("pkInfo").ROOM_CODE,d),T.Storage.set("LQ_timer",o)},M=function(a){o=N();var b=a||3e5,c={millSecond:0,timer:0},d=new Map;$(".talk-shareRecIcon").removeClass("talk-icon3").addClass("talkno-icon3");var e=setInterval(function(){var a=o.shareRecommendInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no).millSecond;a>0?(a-=1e3,o.shareRecommendInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no).millSecond=a,$(".shareRecommend .tab-name").html(new Date(a).format("mm:ss"))):(o.shareRecommendInfo.remove(T.Storage.get("pkInfo").ROOM_CODE),$(".talk-shareRecIcon").removeClass("talkno-icon3").addClass("talk-icon3"),$(".shareRecommend .tab-name").html("分享推荐"),window.clearInterval(e)),T.Storage.set("LQ_timer",o)},1e3);c.timer=e,c.millSecond=b,d.put(T.Storage.get("userinfo").user_no,c),o.shareRecommendInfo.put(T.Storage.get("pkInfo").ROOM_CODE,d),T.Storage.set("LQ_timer",o)},N=function(){var a={shareOrderInfo:new Map,shareRecommendInfo:new Map};if(!T.Util.isEmpty(T.Storage.get("LQ_timer"))){a=T.Storage.get("LQ_timer");var b=new Map;b.container=a.shareOrderInfo.container,a.shareOrderInfo=b;var c=new Map;if(c.container=a.shareRecommendInfo.container,a.shareRecommendInfo=c,!T.Util.isEmpty(a.shareOrderInfo.get(T.Storage.get("pkInfo").ROOM_CODE))){var d=a.shareOrderInfo.get(T.Storage.get("pkInfo").ROOM_CODE),e=new Map;d.container&&(e.container=d.container),a.shareOrderInfo.put(T.Storage.get("pkInfo").ROOM_CODE,e)}if(!T.Util.isEmpty(a.shareRecommendInfo.get(T.Storage.get("pkInfo").ROOM_CODE))){var f=a.shareRecommendInfo.get(T.Storage.get("pkInfo").ROOM_CODE),g=new Map;f.container&&(g.container=f.container),a.shareRecommendInfo.put(T.Storage.get("pkInfo").ROOM_CODE,g)}}return a},O=function(){$(".recommendItem").off().Touch(function(a){if($(".mine-tj .xuan-icon.xuan-on").length>=3&&!$(a).find(".xuan-icon").hasClass("xuan-on"))return void tip("最多分享三个推荐");$(a).find(".xuan-icon").toggleClass("xuan-on"),$(".send-number").html($(".mine-tj .xuan-icon.xuan-on").length),$(".mine-tj .xuan-icon.xuan-on").length?$(".send-fix").removeClass("send-no"):$(".send-fix").addClass("send-no")}),$(".send-fix").off().Touch(function(a){$(this).hasClass("send-no")?tip(1==MessageObj.shareType?"请选择要分享的订单":"请选择要分享的推荐"):1==MessageObj.shareType?J():2==MessageObj.shareType&&K()},{noRepeat:1})};return{getMessage:t,initListeners:p,init:r,clearGetMesTimer:s,shareType:1,getPkOrders:E,getPkRecommends:F,checkShareTimerInfo:function(){if(o=N(),!T.Util.isEmpty(o.shareOrderInfo.get(T.Storage.get("pkInfo").ROOM_CODE))&&!T.Util.isEmpty(o.shareOrderInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no))&&o.shareOrderInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no).millSecond){window.clearInterval(o.shareOrderInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no).timer);var a=o.shareOrderInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no).millSecond;L(a)}if(!T.Util.isEmpty(o.shareRecommendInfo.get(T.Storage.get("pkInfo").ROOM_CODE))&&!T.Util.isEmpty(o.shareRecommendInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no))&&o.shareRecommendInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no).millSecond){window.clearInterval(o.shareRecommendInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no).timer);var b=o.shareRecommendInfo.get(T.Storage.get("pkInfo").ROOM_CODE).get(T.Storage.get("userinfo").user_no).millSecond;M(b)}}}}();T.betClubInfo={getBetResultByStatus:function(a,b){var c,d="";return 110==a?(d=b?"返还 "+b.PRIZE_MONEY:"",c="赢"):-100==a?(d="未中奖",c="输"):a>199?(d=b?"返还"+b.ITEM_MONEY:"",c="金币返还"):-5==a?(d="金币返还中",c="订单取消"):-10==a?(d=b?"金币返还  "+b.ITEM_MONEY:"",c="订单取消"):0==a?(d=b?"预计返还  "+b.ITEM_INFO[0].CLIENT_PROPERTIES.split("|")[2]:"",c="订单确认中"):120==a?(d=b?"返还  "+b.PRIZE_MONEY:"",c="走盘"):130==a?(d=b?"返还  "+b.PRIZE_MONEY:"",c="输半"):140==a?(d=b?"返还 "+b.PRIZE_MONEY:"",c="赢半"):100==a?(d=b?"预计返还  "+b.ITEM_INFO[0].CLIENT_PROPERTIES.split("|")[2]:"",c="结算中"):(d=b?"预计返还  "+b.ITEM_INFO[0].CLIENT_PROPERTIES.split("|")[2]:"",c="待开奖"),[c,T.Util.parseNumber(d)]},getBetInfoByStatus:function(a){var b={result:"",resultCls:"",resultText:"返还：",retMoneyCls:"jb-lose"};return 110==a?(b.result="赢",b.resultCls="win-btn",b.resultText="返还：",b.retMoneyCls="jb-win"):-100==a?(b.result="输",b.resultCls="lose-btn",b.resultText="未中奖"):a>199?(b.result="退单",b.resultCls="unkown-btn",b.resultText="返还："):-5==a?(b.result="退单中",b.resultCls="unkown-btn"):-10==a?(b.result="订单取消",b.resultCls="unkown-btn"):0==a?(b.result="确认中",b.resultCls="unkown-btn",b.resultText="预计返还："):120==a?(b.result="走盘",b.resultCls="zou-btn"):130==a?(b.result="输半",b.resultCls="lose-btn"):140==a?(b.result="赢半",b.resultCls="win-btn",b.retMoneyCls="jb-win"):100==a?(b.result="结算中",b.resultCls="unkown-btn"):(b.result="未结算",b.resultCls="unkown-btn",b.resultText="预计返还："),b},getBetRetMoney:function(a,b){var c=T.Util.parseNumber(parseInt(b.prize_money));return a.resultText.match(/预计返还|结算中/)?c=T.Util.parseNumber(parseInt(b.match_odds*parseInt(b.item_money))):"未中奖"==a.resultText&&(c=""),c},fillSignBetInfo:function(a){var b,c,d,e,f,g,h,i=a.ITEM_INFO[0],j=i.CLIENT_PROPERTIES,k=j.split("|")[1].split("vs"),l="",m="",n=[],o=[],p=[];4==j.split("|").length&&(l="<span>( 当前比分 "+j.split("|")[3]+" )</span>"),b=j.split("|")[0],c=i.MATCH_ODDS,hName=k[0].trim().substr(0,4),gName=k[1].trim().substr(0,4),isGoald="20"==i.PLAY_TYPE,d=new Date(i.MATCH_TIME).format("hh:mm"),f=playtypeObj[i.PLAY_ID].name,g=T.Util.parseNumber(parseInt(a.ITEM_MONEY)),h=a.ITEM_ID,e=new Date(a.CRT_TIME).format("YYYY-MM-dd"),m=1==i.IS_INPLAY?" <span>&nbsp;&nbsp;赛前</span>":' <span class="TZ_green">&nbsp;&nbsp;滚球</span>';var q="",r=T.betClubInfo.getBetResultByStatus(a.ITEM_STATUS,a)[0];"待开奖"==r||"订单确认中"==r?(q="TZ_white",n.push('<span class="TZ_white">'+r+"</span>"),n.push("</p></div><div>回报 : <span>"+c+'</span>倍</div><div class="TZ_beting Color" style="color:#333;font-weight:bold;">投注金币 : <span>'+g+"</span>"),n.push('<p class="floatR"><span>'+T.betClubInfo.getBetResultByStatus(a.ITEM_STATUS,a)[1]+"</span></p>")):r.indexOf("赢")>-1?(n.push('<span style="color:#ff0000;font-size:14px;font-weight:bold;">'+r+"</span>"),n.push("</p></div><div>回报 : <span>"+c+'</span>倍</div><div class="TZ_beting Color" style="color:#333;font-weight:bold;">投注金币 : <span>'+g+"</span>"),n.push('<p class="floatR TZ_yellow"><span>'+T.betClubInfo.getBetResultByStatus(a.ITEM_STATUS,a)[1]+"</span></p>")):r.indexOf("输")>-1?(n.push('<span style="color:#309f0e;font-size:14px;font-weight:bold;">'+r+"</span>"),n.push("</p></div><div>回报 : <span>"+c+'</span>倍</div><div class="TZ_beting Color" style="color:#333;font-weight:bold;">投注金币 : <span>'+g+"</span>"),n.push('<p class="floatR"><span>'+T.betClubInfo.getBetResultByStatus(a.ITEM_STATUS,a)[1]+"</span></p>")):(n.push('<span style="color:#333;font-size:14px;font-weight:bold;">'+r+"</span>"),n.push("</p></div><div>回报 : <span>"+c+'</span>倍</div><div class="TZ_beting Color" style="color:#333;font-weight:bold;">投注金币 : <span>'+g+"</span>"),n.push('<p class="floatR"><span>'+T.betClubInfo.getBetResultByStatus(a.ITEM_STATUS,a)[1]+"</span></p>"));var s="",t="";isGoald&&"5"==i.STATUS_ID?(t=void 0===i.HOME_GOAL_NUM||""==i.HOME_GOAL_NUM?"vs":i.HOME_GOAL_NUM+":"+i.AWAY_GOAL_NUM,s=hName+" "+i.HOME_GOAL_NUM+" : "+i.AWAY_GOAL_NUM+" "+gName):isGoald||"3"!=i.STATUS_ID&&"4"!=i.STATUS_ID&&"5"!=i.STATUS_ID?t="vs":(t=i.FH_HOME_GOAL_NUM+":"+i.FH_AWAY_GOAL_NUM,s=hName+" "+i.FH_HOME_GOAL_NUM+" : "+i.FH_AWAY_GOAL_NUM+" "+gName);var u={htName:hName,gtName:gName,itemMoney:g,statusStr:r,prizeMoney:a.PRIZE_MONEY,shareScore:s};return p.push("<span>"+hName+'</span><span class="Color"> '+t+" </span><span>"+gName+"</span>"),o.push('<div class="TZ_list"><span class="xuan-icon"></span><b class="seleBox hide" data-itemid = "'+h+'" data-matchid = "'+i.MATCH_ID+'" data-share = "'+JSON.stringify(u).replace(/"/g,"'")+'"><i class="selectNo"></i></b><div class="TZ_box1"><div class="TZ_sty Color"><span class="'+q+'" style="color:#333;font-size:14px;font-weight:bold;"><span class="betContent">'+b+"</span>&nbsp;&nbsp;</span>"+l+'<p class="floatR Color" style="font-size:12px;font-weight:normal;"><span>'+f+" </span>"+m+'</p></div><div class="TZ_tim Color"><span>'+p.join("")+"&nbsp;"+d+'</span><p class="floatR" style="margin-top:12px;">'+n.join("")+'</div></div><div class="TZ_box2"><div class="Color">订单号: <span>'+h.substring(0,15)+'</span><p class="floatR"><span>'+e+"</span></p></div></div></div>"),o.join("")},getRecInfoByRecItem:function(a){var b={recType:"",recOps:"",recRet:"",recRetCls:""};0==a.isHit?b.recRet=0==a.singleMoney?"免费查看":a.singleMoney+"钻查看":1==a.isHit?(b.recRet="赢",b.recRetCls="win-btn"):2==a.isHit?(b.recRet="走",b.recRetCls="zou-btn"):-1==a.isHit&&(b.recRet="输",b.recRetCls="lose-btn");var c=JSON.parse(a.matchContent)[a.matchId];return 3==a.recomType?(b.recType="大小球",3==a.recomContent.codes?b.recOps+="大球":0==a.recomContent.codes&&(b.recOps+="小球"),b.recOps+="("+a.recomContent.convert_odds+")"):2==a.recomType?(b.recType="亚盘",3==a.recomContent.codes?b.recOps+=c.h_name:0==a.recomContent.codes&&(b.recOps+=c.g_name),b.recOps+="("+a.recomContent.convert_odds+")"):1==a.recomType&&(b.recType="竞彩单关",3==a.recomContent.codes?b.recOps+=c.h_name:1==a.recomContent.codes?b.recOps+="平":0==a.recomContent.codes&&(b.recOps+=c.g_name)),b}};